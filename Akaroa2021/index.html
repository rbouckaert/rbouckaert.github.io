<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Tree counting</title>

		<link rel="stylesheet" href="../reveal.js-3.3.0/css/reveal.css">
		<link rel="stylesheet" href="../reveal.js-3.3.0/css/theme/sky.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../reveal.js-3.3.0/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js-3.3.0/css/print/pdf.css' : '../reveal.js-3.3.0/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section><div style="font-size:50pt">Matrix representations of tree distributions</div>

				<p>Remco Bouckaert</p>
				<p> <a href="mailto:r.bouckaert@auckland.ac.nz">r.bouckaert@auckland.ac.nz</a></p>
				<p>Akaroa 2021</p>
				</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> 2 </td><td>$\infty$ </td><td> 5 </td></tr>
<tr><td>2 </td><td> - </td><td> 6 </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> 6 </td><td> - </td><td> 4 </td></tr>
<tr><td> 5 </td><td> $\infty$ </td><td> 4 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x0.png"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> <b>2</b> </td><td>$\infty$ </td><td> 5 </td></tr>
<tr><td>2 </td><td> - </td><td> 6 </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> 6 </td><td> - </td><td> 4 </td></tr>
<tr><td> 5 </td><td> $\infty$ </td><td> 4 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x1.png"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> <s>2</s> </td><td>$\infty$ </td><td> 5 </td></tr>
<tr><td>2 </td><td> - </td><td> 6 </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> 6 </td><td> - </td><td> <b>4</b> </td></tr>
<tr><td> 5 </td><td> $\infty$ </td><td> 4 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x2.png"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> <s>2</s> </td><td>$\infty$ </td><td> <s>5</s> </td></tr>
<tr><td>2 </td><td> - </td><td> 6 </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> 6 </td><td> - </td><td> <b>4</b> </td></tr>
<tr><td> 5 </td><td> $\infty$ </td><td> 4 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x2.png"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> <s>2</s> </td><td>$\infty$ </td><td> <s>5</s> </td></tr>
<tr><td>2 </td><td> - </td><td> <b>6</b> </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> 6 </td><td> - </td><td> <del>4</del> </td></tr>
<tr><td> 5 </td><td> $\infty$ </td><td> 4 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x3.png"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>






<section><h4>$D_1$: Cube</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> $\infty$ </td><td>$\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td> F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g1.dot.png"/>
</td>
</table>

</section>

<section><h4>$D_2$: Caterpillar</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>  - </td><td> F </td><td> F </td><td>F </td><td> F </td><td> F</td></tr>
<tr><td> F </td><td> - </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> F </td><td> $\infty$ </td><td> - </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> - </td><td> $\infty$ </td><td> $\infty$ </td></tr>
<tr><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> - </td><td> $\infty$ </td></tr>
<tr><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g2.dot.png"/>
</td>
</table>

</section>

<section><h4>$D_3$: Disconnected graph</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> F </td><td>$\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td> F </td><td> - </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> - </td><td> F </td><td> F </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g3.dot.png"/>
</td>
</table>

</section>

<section><h4>$D_4$: Cycle</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> $\infty$  </td><td>$\infty$ </td><td> $\infty$ </td><td> F</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> $\infty$ </td><td>  $\infty$ </td><td> $\infty$</td></tr>
<tr><td>$\infty$ </td><td>  F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td>  $\infty$ </td><td> F </td><td> - </td><td> F </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g4.dot.png"/>
</td>
</table>

</section>

<section><h4>$D_5$: Double diagonal</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> F  </td><td>$\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> F </td><td>  $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td>  F </td><td> - </td><td> F </td><td> F </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td>  F </td><td> F </td><td> - </td><td> F </td><td> F </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g5.dot.png"/>
</td>
</table>

</section>

<section><h4>$D_6$: Double linked</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> F  </td><td>$\infty$ </td><td>F </td><td> F</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> F </td><td>  $\infty$ </td><td> F</td></tr>
<tr><td>F </td><td>  F </td><td> - </td><td> F </td><td> F </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td>  F </td><td> F </td><td> - </td><td> F </td><td> F </td></tr>
<tr><td>F </td><td> $\infty$ </td><td> F </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td>F </td><td> F </td><td> $\infty$ </td><td> F </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g6.dot.png"/>
</td>
</table>

</section>

<section><h4>$D_7$: Cycle with shortcut</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> $\infty$  </td><td>F </td><td> $\infty$ </td><td> F</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> $\infty$ </td><td>  $\infty$ </td><td> $\infty$</td></tr>
<tr><td>$\infty$ </td><td>  F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td>  $\infty$ </td><td> F </td><td> - </td><td> F </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g7.dot.png"/>
</td>
</table>
</section>
<section><h4>When does a matrix represente a tree?</h4>

<p>If associated adjacency graph connected

<table><tr><td style="vertical-align: top;">
<table>
<tr><td>- </td><td> F </td><td> $\infty$ </td><td>$\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td>F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td> F </td><td> - </td><td> F </td><td> $\infty$ </td><td> $\infty$</td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td><td> $\infty$ </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> $\infty$ </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g1.dot.png"/>
</td>
</table>

</section>

<section><h4>How many trees can a matrix represent?</h4>


<table>
<tr><td>matrix </td><td> </td><td> #parameters </td><td>#trees</td></tr>
<tr><td>full </td><td> </td><td> n(n-1)/2 </td><td>$\prod_{i=2}^n(2i-3)$</td></tr>
<tr><td>cube </td><td> $D_1$ </td><td> n-1 </td><td> $C_n=\frac{1}{n+1}\binom{2n}{n}$</td></tr> 
<tr><td>caterpillar </td><td> $D_2$ </td><td> n-1 </td><td> $n!$</td></tr> 
<tr><td>cycle </td><td> $D_4$ </td><td> n </td><td> $\binom{2n+1}{n+1}$?</td></tr> 
<tr><td>cycleWithShortCut </td><td> $D_7$ </td><td> n+1 </td><td> ?</td></tr> 
<tr><td>doubleDiagonal </td><td> $D_5$ </td><td> 2n-3 </td><td> ?</td></tr> 
<tr><td>doubleLinked </td><td> $D_6$ </td><td> 2n </td><td> ?</td></tr> 
</table>
</section>

<section><h4>How many trees can a matrix represent?</h4>
<img src="figures/diff/grapg.png"/>
</section>


<section><h4>The kind of graph to hope for</h4>

<img src="figures/g.dot.png"/>

<ul>
<li>Small number of parameters/matrix entries
<li>Large coverage of tree distribution
</ul>
</section>



<section><h4>Tree set => matrix => tree set</h4>
<div>Tree set => Matrix
<ul>
<li>Start with a tree set (e.g. posterior tree distribution from BEAST)
<li>Find cube that fits well
<li>Find entries in matrix for remaining clades with $>\epsilon$ support
<li>Define $N(M,\Sigma)$ on entries in matrix (estimate $M$ and $\Sigma$ from input trees)
</ul>

<div>Matrix => tree set
<ul>
<li>Draw entries in matrix from $N(M,\Sigma)$
<li>Use single link clustering to create tree
</ul>
</section>

<section data-transition="none"><h4>Example: Indo European languages -- input</h4>
  <img src="figures/densitree-in.png" width="850" height="600">
</section>
<section data-transition="none"><h4>Example: Indo European languages -- output</h4>
  <img src="figures/densitree-out.png" width="850" height="600">
</section>

<section data-transition="none"><h4>Example: Indo European languages -- difference</h4>
  <img src="figures/diff/diff-ie-uc.png" width="600" height="550">
  
<p> uncorrelated:  $\Sigma$ diagonal matrix
</section>

<section data-transition="none"><h4>Example: Indo European languages -- difference</h4>
  <img src="figures/diff/diff-ie2.png" width="600" height="550">
  
<p> correlated:  $\Sigma$ full matrix
</section>


<section data-transition="none"><h4>Example: Indo European languages -- difference</h4>
  <img src="figures/diff/diff-ie-mono.png" width="600" height="550">
  
<p> correlated + monophyletic constraints
<span style="font-size:20pt">98 taxa, 97 matrix entries, 69 mono constraints

</section>

<section><h3>Applications</h3>
<ul>
<li>Guide distribution for MCMC proposals
<li>Importance distribution for generalised stepping stone/nested sampling
<li>Variational inference
<li>...
</ul>
</section>


<section><h3>Summary</h3>

<p>Matrix distributions:
<ul>
<li>can represent tree distributions
<li>are compact
<li>allows interpretations through adjacency graphs
<li>...
</ul>

<p>To do:
<ul>
<li>find efficient ways to infer matrix distr from sequence data
<li>integrate in applications
<li>...
</ul>

</section>

				</div>
		</div>

		<script src="../reveal.js-3.3.0/lib/js/head.min.js"></script>
		<script src="../reveal.js-3.3.0/js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '../reveal.js-3.3.0/plugin/markdown/marked.js' },
					{ src: '../reveal.js-3.3.0/plugin/markdown/markdown.js' },
					{ src: '../reveal.js-3.3.0/plugin/notes/notes.js', async: true },
					{ src: '../reveal.js-3.3.0/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
		<script src="../reveal.js-3.3.0/plugin/math/math.js"></script>
<script>
  Reveal.initialize({
    math: {
      mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
      config: 'TeX-AMS_HTML-full',
      // pass other options into `MathJax.Hub.Config()`
      TeX: { Macros: { RR: "{\\bf R}" } }
    },
    plugins: [ RevealMath ]
  });
</script>
	</body>
</html>
