<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Tree counting</title>

		<link rel="stylesheet" href="../reveal.js-3.3.0/css/reveal.css">
		<link rel="stylesheet" href="../reveal.js-3.3.0/css/theme/sky.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../reveal.js-3.3.0/lib/css/zenburn.css">
<!--
.reveal section img { background:none; border:none; box-shadow:none; }
-->
<style>	
.reveal section img { background:none; border: 1px solid #eeeeee; box-shadow:none; }
.label {border-right: 2px solid black; color:blue	}
.timg {vertical-align: top;}
</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js-3.3.0/css/print/pdf.css' : '../reveal.js-3.3.0/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section><div style="font-size:50pt">Matrix representations of tree distributions</div>

				<p>Remco Bouckaert</p>
				<p> <a href="mailto:r.bouckaert@auckland.ac.nz">r.bouckaert@auckland.ac.nz</a></p>
				<p>Akaroa 2021</p>
				</section>

<!--
(((1:1,2:1):2,3:3):1,(4:1,5:1):3)
-->
<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label"> 1 </td><td class="label"> 2 </td><td class="label"> 3 </td><td class="label"> 4 </td><td class="label"> 5 </td></tr>
<tr><td class="label">1</td><td> - </td><td> 2 </td><td> 7 </td><td> x </td><td> x </td></tr>
<tr><td class="label">2</td><td> 2 </td><td> - </td><td> 6 </td><td> x </td><td> x </td></tr>
<tr><td class="label">3</td><td> 7 </td><td> 6 </td><td> - </td><td> 8 </td><td> x </td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> 8 </td><td> - </td><td> 2 </td></tr>
<tr><td class="label">5</td><td> x </td><td> x </td><td> x </td><td> 2 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x0.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label"> 1 </td><td class="label"> 2 </td><td class="label"> 3 </td><td class="label"> 4 </td><td class="label"> 5 </td></tr>
<tr><td class="label">1</td><td> - </td><td> <b>2</b> </td><td> 7 </td><td> x </td><td> x </td></tr>
<tr><td class="label">2</td><td> . </td><td> - </td><td> 6 </td><td> x </td><td> x </td></tr>
<tr><td class="label">3</td><td> . </td><td> . </td><td> - </td><td> 8 </td><td> x </td></tr>
<tr><td class="label">4</td><td> . </td><td> . </td><td> . </td><td> - </td><td> 2 </td></tr>
<tr><td class="label">5</td><td> . </td><td> . </td><td> . </td><td> . </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x1.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label"> 1 </td><td class="label"> 2 </td><td class="label"> 3 </td><td class="label"> 4 </td><td class="label"> 5 </td></tr>
<tr><td class="label">1</td><td> - </td><td> <s>2</s> </td><td> 7 </td><td> x </td><td> x </td></tr>
<tr><td class="label">2</td><td> . </td><td> - </td><td> 6 </td><td> x </td><td> x </td></tr>
<tr><td class="label">3</td><td> . </td><td> . </td><td> - </td><td> 8 </td><td> x </td></tr>
<tr><td class="label">4</td><td> . </td><td> . </td><td> . </td><td> - </td><td> <b>2</b> </td></tr>
<tr><td class="label">5</td><td> . </td><td> . </td><td> . </td><td> . </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x2.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label"> 1 </td><td class="label"> 2 </td><td class="label"> 3 </td><td class="label"> 4 </td><td class="label"> 5 </td></tr>
<tr><td class="label">1</td><td> - </td><td> <s>2</s> </td><td> 7 </td><td> x </td><td> x </td></tr>
<tr><td class="label">2</td><td> . </td><td> - </td><td> <b>6</b> </td><td> x </td><td> x </td></tr>
<tr><td class="label">3</td><td> . </td><td> . </td><td> - </td><td> 8 </td><td> x </td></tr>
<tr><td class="label">4</td><td> . </td><td> . </td><td> . </td><td> - </td><td> <s>2</s> </td></tr>
<tr><td class="label">5</td><td> . </td><td> . </td><td> . </td><td> . </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x3.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label"> 1 </td><td class="label"> 2 </td><td class="label"> 3 </td><td class="label"> 4 </td><td class="label"> 5 </td></tr>
<tr><td class="label">1</td><td> - </td><td> <s>2</s> </td><td> <b>7</b> </td><td> x </td><td> x </td></tr>
<tr><td class="label">2</td><td> . </td><td> - </td><td> <s>6</s> </td><td> x </td><td> x </td></tr>
<tr><td class="label">3</td><td> . </td><td> . </td><td> - </td><td> 8 </td><td> x </td></tr>
<tr><td class="label">4</td><td> . </td><td> . </td><td> . </td><td> - </td><td> <s>2</s> </td></tr>
<tr><td class="label">5</td><td> . </td><td> . </td><td> . </td><td> . </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x3.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label"> 1 </td><td class="label"> 2 </td><td class="label"> 3 </td><td class="label"> 4 </td><td class="label"> 5 </td></tr>
<tr><td class="label">1</td><td> - </td><td> <s>2</s> </td><td> <s>7</s> </td><td> x </td><td> x </td></tr>
<tr><td class="label">2</td><td> . </td><td> - </td><td> <s>6</s> </td><td> x </td><td> x </td></tr>
<tr><td class="label">3</td><td> . </td><td> . </td><td> - </td><td> <b>8</b> </td><td> x </td></tr>
<tr><td class="label">4</td><td> . </td><td> . </td><td> . </td><td> - </td><td> <s>2</s> </td></tr>
<tr><td class="label">5</td><td> . </td><td> . </td><td> . </td><td> . </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x4.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<!--
<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td></tr>
<tr><td class="label">1</td><td>- </td><td> 2 </td><td> 5 </td><td> x </td></tr>
<tr><td class="label">2</td><td>2 </td><td> - </td><td> 4 </td><td> x </td></tr>
<tr><td class="label">3</td><td> 5 </td><td> 4 </td><td> - </td><td> 6 </td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> 6 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x0.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td></tr>
<tr><td class="label">1</td><td>- </td><td> <b>2</b> </td><td> 5 </td><td> x </td></tr>
<tr><td class="label">2</td><td>2 </td><td> - </td><td> 4 </td><td> x </td></tr>
<tr><td class="label">3</td><td> 5 </td><td> 4 </td><td> - </td><td> 6 </td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> 6 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x1.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td></tr>
<tr><td class="label">1</td><td>- </td><td> <s>2</s> </td><td> 5 </td><td> x </td></tr>
<tr><td class="label">2</td><td>2 </td><td> - </td><td> <b>4</b> </td><td> x </td></tr>
<tr><td class="label">3</td><td> 5 </td><td> 4 </td><td> - </td><td> 6 </td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> 6 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x2.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td></tr>
<tr><td class="label">1</td><td>- </td><td> <s>2</s> </td><td> <s>5</s> </td><td> x </td></tr>
<tr><td class="label">2</td><td>2 </td><td> - </td><td> 4 </td><td> x </td></tr>
<tr><td class="label">3</td><td> 5 </td><td> 4 </td><td> - </td><td> 6 </td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> 6 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x2.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>

<section data-transition="none"><h4>Matrix => tree by single linke clustering</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td></tr>
<tr><td class="label">1</td><td>- </td><td> <s>2</s> </td><td> <s>5</s> </td><td> x </td></td></tr>
<tr><td class="label">2</td><td>2 </td><td> - </td><td> <s>4</s> </td><td> x </td></tr>
<tr><td class="label">3</td><td> 5 </td><td> 4 </td><td> - </td><td> <b>6</b> </td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> 6 </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/slink/x3.png" width="450"/>
</td>	
</table>
<p style="font-size:20pt">Repeat: find minimum in matrix, connect associated clades (if not already connected)
</section>
-->



<section><h4>How many trees can a matrix represent?</h4>

<table>
<tr style="border-bottom: 1px solid black;"><td> matrix </td><td> </td><td> #parameters </td><td> #trees </td></tr>
<tr><td>full </td><td> </td><td> $n(n-1)/2$ </td><td>$\prod_{i=2}^n(2i-3)$</td></tr>
</table>

<ul>
<li>$n$ = number of taxa
<li>to represent all trees over n taxa requires $\frac{n(n-1)}{2}$ matrix entries
</ul>
</section>

<section><h4>Cube</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> x </td><td>x </td><td> x </td><td> x</td></tr>
<tr><td class="label">2</td><td>F </td><td> - </td><td> F </td><td> x </td><td> x </td><td> x</td></tr>
<tr><td class="label">3</td><td> x </td><td> F </td><td> - </td><td> F </td><td> x </td><td> x</td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> F </td><td> - </td><td> F </td><td> x </td></tr>
<tr><td class="label">5</td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td class="label">6</td><td> x </td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g1.dot.png"/>
</td>
</table>
</section>

<section><h4>How many trees can a matrix represent (II)?</h4>

<table><td>
<table>
<tr style="border-bottom: 1px solid black;"><td> matrix </td><td> </td><td> #parameters </td><td> #trees </td></tr>
<tr><td>full </td><td > </td><td> $n(n-1)/2$ </td><td>$\prod_{i=2}^n(2i-3)$</td></tr>
<tr><td>cube </td><td style="vertical-align: top;"> <img width="50" src="figures/g1.dot.png"/> </td><td> $n-1$ </td><td> $C_n=\frac{1}{n+1}\binom{2n}{n}$</td></tr> 
</table>
</td></table>

</section>


<section><h4>Caterpillar</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> F </td><td>F </td><td> F </td><td> F</td></tr>
<tr><td class="label">2</td><td> F </td><td> - </td><td> x </td><td> x </td><td> x </td><td> x</td></tr>
<tr><td class="label">3</td><td> F </td><td> x </td><td> - </td><td> x </td><td> x </td><td> x</td></tr>
<tr><td class="label">4</td><td> F </td><td> x </td><td> x </td><td> - </td><td> x </td><td> x </td></tr>
<tr><td class="label">5</td><td> F </td><td> x </td><td> x </td><td> x </td><td> - </td><td> x </td></tr>
<tr><td class="label">6</td><td> F </td><td> x </td><td> x </td><td> x </td><td> x </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g2.dot.png"/>
</td>
</table>
</section>

<section><h4>How many trees can a matrix represent (III)?</h4>

<table><td>
<table>
<tr style="border-bottom: 1px solid black;"><td> matrix </td><td> </td><td> #parameters </td><td> #trees </td></tr>
<tr><td>full </td><td> </td><td> $n(n-1)/2$ </td><td>$\prod_{i=2}^n(2i-3)$</td></tr>
<tr><td>cube </td><td style="vertical-align: top;"> <img width="50" src="figures/g1.dot.png"/> </td><td> $n-1$ </td><td> $C_n=\frac{1}{n+1}\binom{2n}{n}$</td></tr> 
<tr><td>caterpillar </td><td style="vertical-align: top;"> <img width="50" src="figures/g2.dot.png"/> </td><td> $n-1$ </td><td> $n!$</td></tr> 
</table>
</td></table>
</section>

<section><h4>When does a matrix represente a tree?</h4>

<p>If associated adjacency graph connected
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> F </td><td>x </td><td> x </td><td> x</td></tr>
<tr><td class="label">2</td><td>F </td><td> - </td><td> F </td><td> x </td><td> x </td><td> x</td></tr>
<tr><td class="label">3</td><td>F </td><td> F </td><td> - </td><td> x </td><td> x </td><td> x</td></tr>
<tr><td class="label">4</td><td> x </td><td> x </td><td> x </td><td> - </td><td> F </td><td> F </td></tr>
<tr><td class="label">5</td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td class="label">6</td><td> x </td><td> x </td><td> x </td><td> F </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g3.dot.png"/>
</td>
</table>
</section>

<section><h4>Cycle</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> x  </td><td>x </td><td> x </td><td> F</td></tr>
<tr><td class="label">2</td><td>F </td><td> - </td><td> F </td><td> x </td><td>  x </td><td> x</td></tr>
<tr><td class="label">3</td><td>x </td><td>  F </td><td> - </td><td> F </td><td> x </td><td> x</td></tr>
<tr><td class="label">4</td><td> x </td><td>  x </td><td> F </td><td> - </td><td> F </td><td> x </td></tr>
<tr><td class="label">5</td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td class="label">6</td><td> F </td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g4.dot.png"/>
</td>
</table>
</section>

<section><h4>How many trees can a matrix represent (IV)?</h4>

<table><td>
<table>
<tr style="border-bottom: 1px solid black;"><td> matrix </td><td> </td><td> #parameters </td><td> #trees </td></tr>
<tr><td>full </td><td> </td><td> $n(n-1)/2$ </td><td>$\prod_{i=2}^n(2i-3)$</td></tr>
<tr><td>cube </td><td style="vertical-align: top;"> <img width="50" src="figures/g1.dot.png"/> </td><td> $n-1$ </td><td> $C_n=\frac{1}{n+1}\binom{2n}{n}$</td></tr> 
<tr><td>caterpillar </td><td style="vertical-align: top;"> <img width="50" src="figures/g2.dot.png"/> </td><td> $n-1$ </td><td> $n!$</td></tr> 
<tr><td>cycle </td><td style="vertical-align: top;"> <img width="50" src="figures/g4.dot.png"/> </td><td> $n$ </td><td> $\binom{2n+1}{n+1}$?</td></tr> 
</table>
</td></table>
</section>

<section><h4>Cycle with shortcut</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> x  </td><td>F </td><td> x </td><td> F</td></tr>
<tr><td class="label">2</td><td>F </td><td> - </td><td> F </td><td> x </td><td>  x </td><td> x</td></tr>
<tr><td class="label">3</td><td>x </td><td>  F </td><td> - </td><td> F </td><td> x </td><td> x</td></tr>
<tr><td class="label">4</td><td>F </td><td>  x </td><td> F </td><td> - </td><td> F </td><td> x </td></tr>
<tr><td class="label">5</td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td class="label">6</td><td> F </td><td> x </td><td> x </td><td> x </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g7.dot.png"/>
</td>
</table>
</section>

<section><h4>Double diagonal</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> F  </td><td>x </td><td> x </td><td> x</td></tr>
<tr><td class="label">2</td><td>F </td><td> - </td><td> F </td><td> F </td><td>  x </td><td> x</td></tr>
<tr><td class="label">3</td><td>F </td><td>  F </td><td> - </td><td> F </td><td> F </td><td> x</td></tr>
<tr><td class="label">4</td><td> x </td><td>  F </td><td> F </td><td> - </td><td> F </td><td> F </td></tr>
<tr><td class="label">5</td><td> x </td><td> x </td><td> F </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td class="label">6</td><td> x </td><td> x </td><td> x </td><td> F </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g5.dot.png"/>
</td>
</table>

</section>

<section><h4>Double linked</h4>
<table><tr><td style="vertical-align: top;">
<table>
<tr style="border-bottom: 1px solid black;"><td></td><td class="label">1 </td><td class="label"> 2 </td><td class="label">3 </td><td class="label"> 4 </td><td class="label">5 </td><td class="label"> 6 </td></tr>
<tr><td class="label">1</td><td>- </td><td> F </td><td> F  </td><td>x </td><td>F </td><td> F</td></tr>
<tr><td class="label">2</td><td>F </td><td> - </td><td> F </td><td> F </td><td>  x </td><td> F</td></tr>
<tr><td class="label">3</td><td>F </td><td>  F </td><td> - </td><td> F </td><td> F </td><td> x</td></tr>
<tr><td class="label">4</td><td> x </td><td>  F </td><td> F </td><td> - </td><td> F </td><td> F </td></tr>
<tr><td class="label">5</td><td>F </td><td> x </td><td> F </td><td> F </td><td> - </td><td> F </td></tr>
<tr><td class="label">6</td><td>F </td><td> F </td><td> x </td><td> F </td><td> F </td><td> - </td></tr>
</table>
</td><td style="vertical-align: top;">
<img src="figures/g6.dot.png"/>
</td>
</table>
</section>


<section><h4>How many trees can a matrix represent (V)?</h4>

<small>
<table><td>
<table>
<tr style="border-bottom: 1px solid black;"><td> matrix </td><td> </td><td> #parameters </td><td> #trees </td></tr>
<tr><td>full </td><td> </td><td> $n(n-1)/2$ </td><td>$\prod_{i=2}^n(2i-3)$</td></tr>
<tr><td>cube </td><td style="vertical-align: top;"> <img width="50" src="figures/g1.dot.png"/> </td><td> $n-1$ </td><td> $C_n=\frac{1}{n+1}\binom{2n}{n}$</td></tr> 
<tr><td>caterpillar </td><td style="vertical-align: top;"> <img width="50" src="figures/g2.dot.png"/> </td><td> $n-1$ </td><td> $n!$</td></tr> 
<tr><td>cycle </td><td style="vertical-align: top;"> <img width="50" src="figures/g4.dot.png"/> </td><td> $n$ </td><td> $\binom{2n+1}{n+1}$?</td></tr> 
<tr><td>cycle with shortcut </td><td style="vertical-align: top;"> <img width="50" src="figures/g7.dot.png"/> </td><td> $n+1$ </td><td> ?</td></tr> 
<tr><td>double diagonal </td><td style="vertical-align: top;"> <img width="50" src="figures/g5.dot.png"/> </td><td> $2n-3$ </td><td> ?</td></tr> 
<tr><td>double linked </td><td style="vertical-align: top;"> <img width="50" src="figures/g6.dot.png"/> </td><td> $2n$ </td><td> ?</td></tr> 
</table>
</td></table></small>
</section>

<section><h4>How many trees can a matrix represent (VI)?</h4>
<img src="figures/diff/grapg.png"/>

<p>Number of trees vs number of taxa
</section>


<section><h4>The kind of graph to hope for</h4>

<img src="figures/g.dot.png"/>

<ul>
<li>Small number of parameters/matrix entries
<li>Large coverage of tree distribution
</ul>
</section>



<section><h4>Tree set => matrix => tree set</h4>
<div>Tree set => Matrix
<ul>
<li>Start with a tree set (e.g. posterior tree distribution from BEAST)
<li>Find cube that fits well
<li>Find entries in matrix for remaining clades with $>\epsilon$ support
<li>Define $N(M,\Sigma)$ on entries in matrix (estimate $M$ and $\Sigma$ from input trees)
</ul>

<div>Matrix => tree set
<ul>
<li>Draw entries in matrix from $N(M,\Sigma)$
<li>Use single link clustering to create tree
</ul>
</section>

<section data-transition="none"><h4>Example: Indo European languages -- input</h4>
  <img src="figures/densitree-out.png" width="850" height="600">
</section>
<section data-transition="none"><h4>Example: Indo European languages -- output</h4>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <img src="figures/densitree-in.png" width="760" height="600">
</section>

<section data-transition="none"><h4>Example: Indo European languages -- difference</h4>
  <img src="figures/diff/diff-ie-uc.png" width="600" height="550">
  
<br/> uncorrelated:  $\Sigma$ diagonal matrix
</section>

<section data-transition="none"><h4>Example: Indo European languages -- difference (II)</h4>
  <img src="figures/diff/diff-ie2.png" width="600" height="550">
  
<br><span style="font-size:20pt"> correlated:
98 taxa, 97 matrix entries, $\Sigma$ full matrix = 4656 (co)variances
</section>


<section data-transition="none"><h4>Example: Indo European languages -- difference (III)</h4>
  <img src="figures/diff/diff-ie-mono.png" width="600" height="550">
  
<br><span style="font-size:20pt"> correlated:
98 taxa, 97 matrix entries, 69 mono constraints, full 4656 (co)variances

</section>

<section data-transition="none"><h4>Example: Indo European languages -- difference (IV</h4>
  <img src="figures/diff/diff-ie-reduced.png" width="600" height="550">
  
<br/><span style="font-size:20pt"> correlated: 
<span style="font-size:20pt">98 taxa, 97 matrix entries, 69 mono constraints, 215 (co)variances
</section>


<section><h4>Applications</h4>
<ul>
<li>Guide distribution for MCMC proposals
<li>Importance distribution for generalised stepping stone/nested sampling
<li>Variational inference
<li>Tree drawing: Good cube => good DensiTree
</ul>
</section>


<section><h4>Summary</h4>

<p>Matrix distributions:
<ul>
<li>can represent tree distributions
<li>are compact
<li>allows interpretations through adjacency graphs
<li>...
</ul>

<br>To do:
<ul>
<li>Proof number of trees for different adjacency graphs
<li>Explore other adjacency graphs
<li>Quantitative measure of distance of tree distributions 
<li>Cube finder
<li>Find ways to infer matrix distr from sequence data
<li>Integrate in applications
<li>...
</ul>

</section>

				</div>
		</div>

		<script src="../reveal.js-3.3.0/lib/js/head.min.js"></script>
		<script src="../reveal.js-3.3.0/js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '../reveal.js-3.3.0/plugin/markdown/marked.js' },
					{ src: '../reveal.js-3.3.0/plugin/markdown/markdown.js' },
					{ src: '../reveal.js-3.3.0/plugin/notes/notes.js', async: true },
					{ src: '../reveal.js-3.3.0/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
		<script src="../reveal.js-3.3.0/plugin/math/math.js"></script>
<script>
  Reveal.initialize({
    math: {
      mathjax: 'lib/MathJax.js',
      config: 'TeX-AMS_HTML-full',
      // pass other options into `MathJax.Hub.Config()`
      TeX: { Macros: { RR: "{\\bf R}" } }
    },
    plugins: [ RevealMath ]
  });
</script>
<!--
//      mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
-->
	</body>
</html>
<!--

	2 Matrix => tree by single linke clustering
	  Matrix => tree by single linke clustering
	  Matrix => tree by single linke clustering
	  Matrix => tree by single linke clustering
	  Matrix => tree by single linke clustering
2	1 How many trees can a matrix represent?
3	1 Cube
	  How many trees can a matrix represent?
4	2 Caterpillar
	  How many trees can a matrix represent?
6	2 When does a matrix represente a tree?
8	1 Cycle
	  How many trees can a matrix represent?
9	1 Cycle with shortcut
	  Double diagonal
	  Double linked
10	1 How many trees can a matrix represent?
12	2 How many trees can a matrix represent?
11	1 The kind of graph to hope for
12	2 Tree set => matrix => tree set
13	1 Example: Indo European languages -- input
	  Example: Indo European languages -- output
15	2 Example: Indo European languages -- difference
16	1  Example: Indo European languages -- difference
17	1  Example: Indo European languages -- difference
18	1  Applications
20	2  Summary
-->